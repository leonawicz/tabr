<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Engraving • tabr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Engraving">
<meta property="og:description" content="">
<meta property="og:image" content="http://leonawicz.github.io/tabr/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-46129458-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-46129458-3');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-info-circle"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transcription</li>
    <li>
      <a href="../articles/tabr-basics.html">Basic example</a>
    </li>
    <li>
      <a href="../articles/tabr-phrases.html">Musical phrases</a>
    </li>
    <li>
      <a href="../articles/tabr-helpers.html">Phrase helpers</a>
    </li>
    <li>
      <a href="../articles/tabr-chords.html">Chords</a>
    </li>
    <li>
      <a href="../articles/tabr-repeats.html">Repeats</a>
    </li>
    <li>
      <a href="../articles/tabr-tracks-scores.html">Tracks and scores</a>
    </li>
    <li>
      <a href="../articles/tabr-engraving.html">Engraving</a>
    </li>
    <li>
      <a href="../articles/tabr-tunings.html">Strings and tunings</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Programming</li>
    <li>
      <a href="../articles/tabr-prog-nw.html">Noteworthiness</a>
    </li>
    <li>
      <a href="../articles/tabr-prog-scales.html">Musical scales</a>
    </li>
    <li>
      <a href="../articles/tabr-prog-notes.html">Note functions</a>
    </li>
    <li>
      <a href="../articles/tabr-prog-chords.html">Chord functions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tabr-ex1.html">Tuning and capo</a>
    </li>
    <li>
      <a href="../articles/tabr-ex2.html">Multiple voices</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leonawicz/tabr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Engraving</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leonawicz/tabr/blob/master/vignettes/tabr-engraving.Rmd"><code>vignettes/tabr-engraving.Rmd</code></a></small>
      <div class="hidden name"><code>tabr-engraving.Rmd</code></div>

    </div>

    
    
<p>This section covers <code>lilypond</code> and <code>tab</code> for writing LilyPond files and engraving to sheet music with LilyPond, respectively. Examples of the various pieces of song metadata that can be passed to to these functions are provided.</p>
<p>The examples focus on <code>tab</code> because this generates the tablature whereas <code>lilypond</code> only creates the LilyPond file that <code>tab</code> renders. <code>tab</code> is a wrapper around <code>lilypond</code>. The two functions have identical arguments, as <code>tab</code> merely passes them along to <code>lilypond</code> internally, except for one. <code>tab</code> has <code>keep_ly = FALSE</code> by default, which removes the <code>.ly</code> file created by <code>lilypond</code> following rendering of the file to pdf or png. To keep the LilyPond file, set this to <code>TRUE</code>. All other arguments are the same for both functions so they are really <code>lilypond</code> arguments.</p>
<p>Here are the <code>lilypond</code> arguments:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tabr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/args">args</a></span>(lilypond)
<span class="co">#&gt; function (score, file, key = "c", time = "4/4", tempo = "2 = 60", </span>
<span class="co">#&gt;     header = NULL, string_names = NULL, paper = NULL, endbar = TRUE, </span>
<span class="co">#&gt;     midi = TRUE, path = NULL) </span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>By now you have seen many calls to <code>tab</code> in order to show full examples in early tutorial sections. With sufficient coverage of phrases, tracks and scores, and the progression through them, now it is time to go into detail on all the render time arguments that can be supplied that apply to the entire piece of tablature and any metadata or general song information associated with it.</p>
<div id="score-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#score-metadata" class="anchor"></a>Score metadata</h2>
<p>These are the most critical components that can be supplied to <code>lilypond</code>. These are the three arguments immediately after the input <code>score</code> and output <code>file</code>. While they have default values, they will almost invariably need to be changed for just about any song. <code>key</code> specifies the key signature, e.g. <code>key ="dm"</code>. Key changes in the middle of a song are not supported, but you can always edit the LilyPond file by hand to make highly customized changes. <code>time</code> gives the time signature, defaulting to common time, or 4/4 time. <code>tempo</code> provides the song tempo, defaulting to <code>tempo = "2 = 60"</code>. Note that <code>key</code> takes the <code>tabr</code> consistent key signature notation whereas <code>time</code> and <code>tempo</code> take literal LilyPond strings. Look up options for these strings if you are not familiar with them in LilyPond.</p>
<p>Throughout this tutorial section, the guitar and bass example from the section on tracks and scores is reused. The chord chart and chord sequence are retained to provide the most complete illustration of a rendered score. For completeness, here is what you have so far.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">voice1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/repeats.html">rp</a></span>(<span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"c5 d5 e5 f5 g5"</span>, <span class="st">"1 2 4 4 1"</span>, <span class="st">"1*5"</span>), <span class="dv">2</span>)

notes &lt;-<span class="st"> "c e g c' e' c' g e g b d' g' f a c' f' c e g e c"</span>
strings &lt;-<span class="st"> "5 4 3 2 1 2 3 4 4 3 2 1 4 3 2 1 5 4 3 4 5"</span>
voice2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/repeats.html">rp</a></span>(<span class="kw"><a href="../reference/phrase.html">p</a></span>(notes, <span class="st">"8*20 2"</span>, strings), <span class="dv">2</span>)

bass &lt;-<span class="st"> </span><span class="kw"><a href="../reference/repeats.html">rp</a></span>(<span class="kw"><a href="../reference/phrase.html">p</a></span>(<span class="st">"c2e2*4 g1*2 f1*2 c2e2*3"</span>, <span class="st">"4*10 2"</span>, <span class="st">"32*4 4*4 32*3"</span>), <span class="dv">2</span>)

t1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/track.html">track</a></span>(voice1, <span class="dt">voice =</span> <span class="dv">1</span>)
t2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/track.html">track</a></span>(voice2, <span class="dt">voice =</span> <span class="dv">2</span>)
t3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/track.html">track</a></span>(bass, <span class="dt">tuning =</span> <span class="st">"bass"</span>, <span class="dt">music_staff =</span> <span class="st">"bass_8"</span>)

chords &lt;-<span class="st"> </span><span class="kw"><a href="../reference/chord_set.html">chord_set</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">c =</span> <span class="st">"x32o1o"</span>, <span class="dt">g =</span> <span class="st">"355433"</span>, <span class="dt">f =</span> <span class="st">"133211"</span>))
chord_seq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/setNames">setNames</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(chords)[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">1</span>)]), <span class="dv">3</span>)
chords
<span class="co">#&gt;              c              g              f </span>
<span class="co">#&gt; "x;3;2;o;1;o;" "3;5;5;4;3;3;" "1;3;3;2;1;1;"</span>
chord_seq
<span class="co">#&gt; c g f c c g f c c g f c </span>
<span class="co">#&gt; 1 2 2 1 1 2 2 1 1 2 2 1</span>

song &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trackbind.html">trackbind</a></span>(t1, t2, t3, <span class="dt">tabstaff =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/score.html">score</a></span>(chords, chord_seq)
song
<span class="co">#&gt; # A tibble: 3 x 7</span>
<span class="co">#&gt;   phrase       tuning         voice staff    ms_transpose ms_key tabstaff</span>
<span class="co">#&gt;   &lt;list&gt;       &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1 &lt;S3: phrase&gt; e, a, d g b e'     1 treble_8            0 &lt;NA&gt;          1</span>
<span class="co">#&gt; 2 &lt;S3: phrase&gt; e, a, d g b e'     2 treble_8            0 &lt;NA&gt;          1</span>
<span class="co">#&gt; 3 &lt;S3: phrase&gt; e,, a,, d, g,      1 bass_8              0 &lt;NA&gt;          2</span></code></pre></div>
<p>This time, when rendering the song, use settings for the three arguments discussed above. Given what is written, it doesn’t make sense to change them all. For example, this won’t fit well as a waltz (time = “3/4”). But for illustration purposes, pretend the song is actually in the key of D minor (F major). This key has one flat, B, so this will force the B note in the G chord to be annotated as an accidental. Change the time to <code>2/2</code> just for the sake of changing it, which won’t really be any different from <code>4/4</code> except you will see a line through the common time symbol. Finally, change the tempo to <code>4 = 120</code>, which is also equivalent to the default, but will show up in the output slightly differently as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/lilypond.html">lilypond</a></span>(song, <span class="st">"ex32.ly"</span>, <span class="st">"dm"</span>, <span class="st">"2/2"</span>, <span class="st">"4 = 120"</span>)
<span class="kw"><a href="../reference/tab.html">tab</a></span>(song, <span class="st">"ex32.pdf"</span>, <span class="st">"dm"</span>, <span class="st">"2/2"</span>, <span class="st">"4 = 120"</span>)</code></pre></div>
<p>
<img src="https://github.com/leonawicz/tabr/blob/master/data-raw/vignette-pngs/ex32.png?raw=true" class="centerimg" width="100%"></p>
<p>Notice how the key change alone, which added room for a single flat symbol to be squeezed into the start of the treble and bass clef staves, was enough to push everything to the point of wrapping around onto a second entire line compared to the earlier tutorial section where it all fit on one line. This is because it was a really tight fit to in the previous examples and there was not enough room for LilyPond to continue fitting everything on one line with this slight widening created by the key change. LilyPond generates sheet music with a somewhat responsive layout engraver. It won’t leave everything on line one jam packaged and push a single measure to the line two. This will return to fitting on one line in a moment when we revert the key change.</p>
<div id="output-file-and-path" class="section level3">
<h3 class="hasAnchor">
<a href="#output-file-and-path" class="anchor"></a>Output file and path</h3>
<p>The output file specified with <code>file</code> ends in pdf in every example. However, you can switch to png output simply by specifying a file name with that extension. <code>file</code> can specify just the file named or the path to the file. The path may be relative or absolute. Optionally, the path to the output file can be passed separately to <code>path</code>, which otherwise defaults to <code>NULL</code>.</p>
</div>
</div>
<div id="song-information" class="section level2">
<h2 class="hasAnchor">
<a href="#song-information" class="anchor"></a>Song information</h2>
<p>The next important argument to <code>lilypond</code> is <code>header</code>. <code>header</code> takes a named list of character strings that are used to fill in general song information such as the title and composer. All previous examples were blank above the tabs because none of this information was ever provided. Below an example is given that uses all available arguments. You can use any subset of these. There is no requirement to supply them all. This example just shows what is available. Several of these would likely not be used in most cases.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">header &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">title =</span> <span class="st">"Song title"</span>, <span class="dt">composer =</span> <span class="st">"Words and music by the composer"</span>, 
    <span class="dt">performer =</span> <span class="st">"Song performer"</span>, <span class="dt">album =</span> <span class="st">"Album title"</span>, <span class="dt">subtitle =</span> <span class="st">"Subtitle"</span>, 
    <span class="dt">arranger =</span> <span class="st">"Arranged by tab arranger"</span>, <span class="dt">copyright =</span> <span class="st">"2018 &lt;Record Label&gt;"</span>, 
    <span class="dt">instrument =</span> <span class="st">"guitar and bass"</span>, <span class="dt">tagline =</span> <span class="st">"A tagline"</span>, <span class="dt">meter =</span> <span class="st">"meter tag"</span>, 
    <span class="dt">opus =</span> <span class="st">"opus tag"</span>, <span class="dt">piece =</span> <span class="st">"piece tag"</span>, <span class="dt">poet =</span> <span class="st">"poet tag"</span>)

<span class="kw"><a href="../reference/tab.html">tab</a></span>(song, <span class="st">"ex33.pdf"</span>, <span class="dt">header =</span> header)</code></pre></div>
<p>
<img src="https://github.com/leonawicz/tabr/blob/master/data-raw/vignette-pngs/ex33.png?raw=true" class="centerimg" width="100%"></p>
<p>The copyright and tagline are cutoff in the above image, but in your pdf you will see these if you scroll to the bottom of the rendered page.</p>
</div>
<div id="other-settings" class="section level2">
<h2 class="hasAnchor">
<a href="#other-settings" class="anchor"></a>Other settings</h2>
<div id="midi-files" class="section level3">
<h3 class="hasAnchor">
<a href="#midi-files" class="anchor"></a>MIDI files</h3>
<p>You have probably noticed by now that every time a pdf if rendered, an accompanying MIDI file is also generated. This can be turned off with <code>midi = FALSE</code>. This specification goes into the LilyPond file itself via <code>lilypond</code>. Therefore, no MIDI output will be created even if you create the LilyPond file with <code>lilypond</code> but convert that to pdf with LilyPond outside of R.</p>
<p>One thing to note about MIDI files is that <code>tabr</code> will unfold any repeats that occur in a song due to calls to <code>rp</code>, <code>pct</code> or <code>volta</code>. This allows the MIDI file to play everything the proper number of times rather than ending prematurely by not being able to read repeat notation.</p>
<p>Also, <code>tabr</code> is a package aimed at creating guitar tablature. It is not concerned with MIDI or audio signals and audio data in general. Any MIDI functionality is considered to be an extra feature and does not receive priority development or support. At this time, there is no way to make other alterations to the MIDI file internals. MIDI output can be toggled on or off as mentioned. And without you having to do anything, MIDI output will respect repeat notation in the rendered LilyPond file. MIDI output will also automatically be transposed to match a transposition that is applied to a music staff (under reasonable and simplified conditions).</p>
</div>
<div id="string-names" class="section level3">
<h3 class="hasAnchor">
<a href="#string-names" class="anchor"></a>String names</h3>
<p>The <code>string_names</code> argument defaults to <code>NULL</code>. This means that standard tuning is never specified alongside the lines of a tab staff at the beginning of the tablature. However, any other tuning will be explicitly noted so the reader is aware of the alternate tuning of any applicable track. This can also be set to <code>TRUE</code> to force all tunings to be explicit including standard guitar tuning or <code>FALSE</code> to suppress them all (though it is unclear what value there is in the <code>FALSE</code> setting).</p>
</div>
<div id="paper-settings" class="section level3">
<h3 class="hasAnchor">
<a href="#paper-settings" class="anchor"></a>Paper settings</h3>
<p>There is some nominal level of control over the paper layout via <code>paper</code>. Like <code>header</code>, this is a named list. The defaults are fine so you probably do not need to alter most of these values. There are six options, all numeric except for <code>page_numbers</code>, which is logical.</p>
<ul>
<li><code>textheight</code></li>
<li><code>linewidth</code></li>
<li><code>indent</code></li>
<li><code>first_page_number</code></li>
<li><code>page_numbers</code></li>
<li><code>fontsize</code></li>
</ul>
<p>If you pass any values for some of these in a named list to <code>paper</code>, any not passed will retain their built in defaults. You do not have to supply them all when using <code>paper</code>.</p>
<p>For more detail on these settings and others further above, see the help documentation, <code><a href="../reference/lilypond.html">?lilypond</a></code>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#score-metadata">Score metadata</a></li>
      <li><a href="#song-information">Song information</a></li>
      <li><a href="#other-settings">Other settings</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://leonawicz.github.io/">Matthew Leonawicz</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
